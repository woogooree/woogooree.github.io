{"componentChunkName":"component---src-templates-blog-template-js","path":"/RS485_02/","result":{"data":{"cur":{"id":"fadea01a-50f2-577a-942c-083887f7dc63","html":"<h2 id=\"modbus-rtu-프로토콜-serial-remote-terminal-unit\" style=\"position:relative;\"><a href=\"#modbus-rtu-%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C-serial-remote-terminal-unit\" aria-label=\"modbus rtu 프로토콜 serial remote terminal unit permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Modbus RTU 프로토콜 (Serial Remote Terminal Unit)</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACr0lEQVQoz02Q20uTcRiAfzdBdiC6COwmulNEgigogogiw267qO6q/6EDWlYX3RZUaBqrZkqpc55m7nzQObd9W5u2pE1LO1BWTuecc9+3fd+e8DOoi4fnfR94b14hLY/QmLzB3Zlb3End5PZf7vxFn5M3uZ381zZ7I03Jhk1SDTR9aODWfCOiYeEa4q1AxHchJndsMrUTEdqOeLMV4alAOCv+2VGBmNiGSOxGTO9FTFci3lciEpWIz/sRM7Kd4WwrQz+f4JaNOPMvcBeM2LMGhr634M4bceae4143YvnVijX9FK/cyUD6Hq3J8zQnLvBAOseT1EVMXy8jKCdAi1PKh4AEMAW805u6Hv6vJdBkCUoS8IUfv65itm2hx1JJv2MPQ67dhKf3I2QtxlppnPSqB4UwBS2ITIi1UoClnBeFkN42nMn7yBb8lJGIT7owNPdjaOmm7fFrjE/76OlwIYpaDFmdYGVtFI0IxXKYEhKyGiS7NoqqtxAqEqvrY+TlABAhHvXTdt/Js0dWDI9sGB46MLX7EYqaYF2RWM6OU9TiOipxCsWI3jZmRY3pzuQC5PQ3xJhNRnFaQlgHPPR32fBagwQ8EUTq+3UsE/swuWrwTFYRm6vH4j+M2VtNv6+aofEqJr/U44oeoc9bxaC/Bnf8IO++nWUkXItNqmXQX8VIqJbw3AHE1Kcm+nzHMLlOY4/UEUpewuQ4wyvrCcyek/S6TyHNXKF98DiG3sO0dR+iz1NHOHWJbvsJDL1HeG4+So/jJP735xEz82OMBs04fF2E48Mk57xMRAf03enrIhAd5OPXMbzjJt44Ohm2dxCIbDS/fmext2OxvcQXNDM960ZoWhGtrFBm04qSZ3FxgZVsmuzqEsvLv8lkFvV9w5mVRb2l0z8pFHKUy0U0TUFVZf3+D2UysQe4ReFuAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Modbus.png\"\n        title=\"Modbus.png\"\n        src=\"/static/8019450f9345b05b1b68a0f82f74a4c8/37523/Modbus.png\"\n        srcset=\"/static/8019450f9345b05b1b68a0f82f74a4c8/e9ff0/Modbus.png 180w,\n/static/8019450f9345b05b1b68a0f82f74a4c8/f21e7/Modbus.png 360w,\n/static/8019450f9345b05b1b68a0f82f74a4c8/37523/Modbus.png 720w,\n/static/8019450f9345b05b1b68a0f82f74a4c8/561da/Modbus.png 969w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Modbus 프로토콜은 시리얼과 TCP/UDP에서 활용할 수 있는데, 그중 시리얼통신인 485로 4선 통신하는 경우는 RTU가 많이 사용된다.\r\n구매한 전력계 제품은 2선통신 임에도 설계하신 분이 RTU를 사용하는 설계를 사용하셔서 2선 통신으로 RTU 프로토콜을 사용해보게 되었다.</p>\n<h2 id=\"프레임-구조\" style=\"position:relative;\"><a href=\"#%ED%94%84%EB%A0%88%EC%9E%84-%EA%B5%AC%EC%A1%B0\" aria-label=\"프레임 구조 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>프레임 구조</h2>\n<ul>\n<li>슬레이브 주소 (Slave Address): 1 바이트 (0-255)</li>\n<li>기능 코드 (Function Code): 1 바이트 (1-255)</li>\n<li>데이터 (Data): n 바이트 (기능 코드에 따라 다름)</li>\n<li>CRC: 2 바이트</li>\n</ul>\n<h2 id=\"통신-방식\" style=\"position:relative;\"><a href=\"#%ED%86%B5%EC%8B%A0-%EB%B0%A9%EC%8B%9D\" aria-label=\"통신 방식 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>통신 방식</h2>\n<p>Modbus RTU는 마스터-슬레이브 구조를 사용한다. 마스터 디바이스는 통신을 시작하고 슬레이브 디바이스는 응답하는 형태로 동작한다. 한 번에 하나의 마스터만 존재할 수 있으며, 다수의 슬레이브가 존재할 수 있다.</p>\n<h2 id=\"주요-기능-코드\" style=\"position:relative;\"><a href=\"#%EC%A3%BC%EC%9A%94-%EA%B8%B0%EB%8A%A5-%EC%BD%94%EB%93%9C\" aria-label=\"주요 기능 코드 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>주요 기능 코드</h2>\n<ul>\n<li>0x01: Read Coil Status (디지털 출력 상태 읽기)</li>\n<li>0x04: Read Input Registers (아날로그 입력 레지스터 읽기)</li>\n<li>0x05: Force Single Coil (단일 Coil 제어)</li>\n<li>0x0F: Force Multiple Coils (다중 Coil 제어)</li>\n<li>0x10: Preset Multiple Registers (다중 레지스터 제어)</li>\n</ul>\n<h3 id=\"예제\" style=\"position:relative;\"><a href=\"#%EC%98%88%EC%A0%9C\" aria-label=\"예제 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>예제</h3>\n<ol>\n<li>\n<p><strong>0x01: Read Coil Status</strong></p>\n<ul>\n<li>요청 (Query):\n<ul>\n<li>슬래이브 주소: 0x11</li>\n<li>기능 코드: 0x01</li>\n<li>레지스터 시작 주소: 0x0003</li>\n<li>포인트 수: 0x0012</li>\n</ul>\n</li>\n<li>응답 (Response):\n<ul>\n<li>슬래이브 주소: 0x11</li>\n<li>기능 코드: 0x01</li>\n<li>바이트 수: 0x03</li>\n<li>데이터: 0xCD, 0x6B, 0x02</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>0x04: Read Input Registers</strong></p>\n<ul>\n<li>요청 (Query):\n<ul>\n<li>슬래이브 주소: 0x0A</li>\n<li>기능 코드: 0x04</li>\n<li>레지스터 시작 주소: 0x0000</li>\n<li>포인트 수: 0x0002</li>\n</ul>\n</li>\n<li>응답 (Response):\n<ul>\n<li>슬래이브 주소: 0x0A</li>\n<li>기능 코드: 0x04</li>\n<li>바이트 수: 0x04</li>\n<li>데이터: 0x022B, 0x0064</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><strong>0x05: Force Single Coil</strong></p>\n<ul>\n<li>요청 (Query):\n<ul>\n<li>슬래이브 주소: 0x11</li>\n<li>기능 코드: 0x05</li>\n<li>레지스터 주소: 0x0002</li>\n<li>제어 상태값: 0xFF00 (ON)</li>\n</ul>\n</li>\n<li>응답 (Response):\n<ul>\n<li>슬래이브 주소: 0x11</li>\n<li>기능 코드: 0x05</li>\n<li>레지스터 주소: 0x0002</li>\n<li>제어 상태값: 0xFF00</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"crc-검사\" style=\"position:relative;\"><a href=\"#crc-%EA%B2%80%EC%82%AC\" aria-label=\"crc 검사 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CRC 검사</h2>\n<p>CRC는 전송 메시지의 끝에 추가되어 수신 측이 수신 데이터를 바이트씩 수신할 때마다 계산한 값과 비교하여 수신 에러 여부를 판단한다. CRC는 16비트로 구성되며, <strong>전송 메시지에서 하위 바이트가 먼저 전송되고 상위 바이트가 뒤이어 전송된다.</strong></p>\n<h3 id=\"crc-코드-생성-방법-c언어\" style=\"position:relative;\"><a href=\"#crc-%EC%BD%94%EB%93%9C-%EC%83%9D%EC%84%B1-%EB%B0%A9%EB%B2%95-c%EC%96%B8%EC%96%B4\" aria-label=\"crc 코드 생성 방법 c언어 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CRC 코드 생성 방법 (C언어)</h3>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">byte OutBuff<span class=\"token punctuation\">[</span><span class=\"token number\">32</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x04</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0F</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//전송 데이터 버퍼</span>\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">CRC_Maker</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint8_t</span> <span class=\"token operator\">*</span>data<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint8_t</span> length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token class-name\">uint16_t</span> C <span class=\"token operator\">=</span> <span class=\"token number\">0xFFFF</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// CRC 초기값 0xFFFF로 16bit 모두 1</span>\r\n    <span class=\"token class-name\">uint8_t</span> D<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 수신한 데이터 8bit</span>\r\n    <span class=\"token class-name\">uint16_t</span> CY<span class=\"token punctuation\">,</span> DD<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// 모든 데이터가 수신될 때 까지 반복</span>\r\n        D <span class=\"token operator\">=</span> OutBuff<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        C <span class=\"token operator\">=</span> C <span class=\"token operator\">^</span> D<span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 수신한 8bit 와 하위CRC 8bit 를 Exclusive OR</span>\r\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j <span class=\"token operator\">&lt;</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            CY <span class=\"token operator\">=</span> C <span class=\"token operator\">&amp;</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> C <span class=\"token operator\">=</span> C <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span> C <span class=\"token operator\">=</span> C <span class=\"token operator\">>></span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token comment\">// CRC 코드를 1bit씩 >> 하고 하위비트 값을 적출하고 상위비트는 0</span>\r\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>CY <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                C <span class=\"token operator\">=</span> C <span class=\"token operator\">^</span> <span class=\"token number\">0xA001</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//적출한 하위비트가 1이면 0xA001이랑 Exclusive OR</span>\r\n            <span class=\"token punctuation\">}</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    DD <span class=\"token operator\">=</span> C <span class=\"token operator\">/</span> <span class=\"token number\">256</span><span class=\"token punctuation\">;</span>\r\n    OutBuff<span class=\"token punctuation\">[</span>length<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>byte<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>C <span class=\"token operator\">-</span> DD <span class=\"token operator\">*</span> <span class=\"token number\">256</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">;</span>  <span class=\"token comment\">// CRC_low</span>\r\n    OutBuff<span class=\"token punctuation\">[</span>length <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>byte<span class=\"token punctuation\">)</span> DD<span class=\"token punctuation\">;</span>  <span class=\"token comment\">// CRC_high</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"전력계에서-전력데이터를-가져오는-법\" style=\"position:relative;\"><a href=\"#%EC%A0%84%EB%A0%A5%EA%B3%84%EC%97%90%EC%84%9C-%EC%A0%84%EB%A0%A5%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A5%BC-%EA%B0%80%EC%A0%B8%EC%98%A4%EB%8A%94-%EB%B2%95\" aria-label=\"전력계에서 전력데이터를 가져오는 법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>전력계에서 전력데이터를 가져오는 법</h2>\n<p><strong>0x04 (Read Input Registers) 를 사용해야 한다.</strong></p>\n<h2 id=\"내가-산-전력계의-통신-레지스터-주소-구성\" style=\"position:relative;\"><a href=\"#%EB%82%B4%EA%B0%80-%EC%82%B0-%EC%A0%84%EB%A0%A5%EA%B3%84%EC%9D%98-%ED%86%B5%EC%8B%A0-%EB%A0%88%EC%A7%80%EC%8A%A4%ED%84%B0-%EC%A3%BC%EC%86%8C-%EA%B5%AC%EC%84%B1\" aria-label=\"내가 산 전력계의 통신 레지스터 주소 구성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>내가 산 전력계의 통신 레지스터 주소 구성</h2>\n<h3 id=\"pm-b-pm-c-d-kcpm\" style=\"position:relative;\"><a href=\"#pm-b-pm-c-d-kcpm\" aria-label=\"pm b pm c d kcpm permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PM-B (PM-C, D, KCPM)</h3>\n<p>30001: 전압 1-2 (V12)\r\n30002: 전압 2-3 (V23)\r\n30003: 전압 3-1 (V31)\r\n30004: 전류 1 (A1)\r\n30005: 전류 2 (A2)\r\n30006: 전류 3 (A3)\r\n30007: 전력 (W)\r\n30008: 역률 (Pf)\r\n30009: 무효전력 (Var)\r\n30010: 주파수 (Hz)\r\n30011: 적산전력 상위 (Wh High)\r\n30012: 적산전력 하위 (Wh Low)\r\n30013: 적산무효전력 상위 (Varh High)\r\n30014: 적산무효전력 하위 (Varh Low)</p>\n<h3 id=\"전력-사용량-데이터-요청-코드-예시-c언어\" style=\"position:relative;\"><a href=\"#%EC%A0%84%EB%A0%A5-%EC%82%AC%EC%9A%A9%EB%9F%89-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%9A%94%EC%B2%AD-%EC%BD%94%EB%93%9C-%EC%98%88%EC%8B%9C-c%EC%96%B8%EC%96%B4\" aria-label=\"전력 사용량 데이터 요청 코드 예시 c언어 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>전력 사용량 데이터 요청 코드 예시 (C언어)</h3>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdint.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;windows.h></span></span>\r\n\r\n<span class=\"token comment\">// CRC 계산을 위한 함수 선언</span>\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">CRC_Maker</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint8_t</span> <span class=\"token operator\">*</span>data<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint8_t</span> length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// Modbus RTU 프레임을 슬레이브로 전송하는 함수</span>\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">sendModbusRequest</span><span class=\"token punctuation\">(</span>HANDLE hSerial<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint8_t</span> slaveAddress<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint16_t</span> startAddress<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint16_t</span> registerCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// COM 포트 설정 함수</span>\r\nHANDLE <span class=\"token function\">setupSerialPort</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span> portName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// COM 포트 설정</span>\r\n    HANDLE hSerial <span class=\"token operator\">=</span> <span class=\"token function\">setupSerialPort</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"COM4\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// COM 포트 설정 실패 시 에러 메시지 출력 후 종료</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hSerial <span class=\"token operator\">==</span> INVALID_HANDLE_VALUE<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Failed to open COM4 port\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token comment\">// 슬레이브 주소, 시작 주소, 레지스터 수 설정</span>\r\n    <span class=\"token class-name\">uint8_t</span> slaveAddress <span class=\"token operator\">=</span> <span class=\"token number\">0x01</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 슬레이브 주소</span>\r\n    <span class=\"token class-name\">uint16_t</span> startAddress <span class=\"token operator\">=</span> <span class=\"token number\">0x0000</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 시작 주소 (전력 사용량 데이터의 시작 주소, 예시로 0x0000 설정)</span>\r\n    <span class=\"token class-name\">uint16_t</span> registerCount <span class=\"token operator\">=</span> <span class=\"token number\">0x0002</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 요청할 레지스터 수 (2개의 레지스터, 4바이트 데이터)</span>\r\n\r\n    <span class=\"token comment\">// 무한 루프를 통해 1시간마다 데이터 요청</span>\r\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// Modbus RTU 요청 전송</span>\r\n        <span class=\"token function\">sendModbusRequest</span><span class=\"token punctuation\">(</span>hSerial<span class=\"token punctuation\">,</span> slaveAddress<span class=\"token punctuation\">,</span> startAddress<span class=\"token punctuation\">,</span> registerCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// 1시간 대기 (3600000 milliseconds = 1 hour)</span>\r\n        <span class=\"token function\">Sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">3600000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token comment\">// 사용 완료 후 COM 포트 핸들 닫기</span>\r\n    <span class=\"token function\">CloseHandle</span><span class=\"token punctuation\">(</span>hSerial<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token comment\">// CRC 계산 함수</span>\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">CRC_Maker</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint8_t</span> <span class=\"token operator\">*</span>data<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint8_t</span> length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token class-name\">uint16_t</span> C <span class=\"token operator\">=</span> <span class=\"token number\">0xFFFF</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// CRC 초기값 0xFFFF 설정</span>\r\n    <span class=\"token class-name\">uint8_t</span> D<span class=\"token punctuation\">;</span>\r\n    <span class=\"token class-name\">uint16_t</span> CY<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// 주어진 데이터 배열을 순회하며 CRC 계산</span>\r\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">uint8_t</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        D <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        C <span class=\"token operator\">=</span> C <span class=\"token operator\">^</span> D<span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 데이터와 CRC 값 XOR 연산</span>\r\n        <span class=\"token comment\">// 8비트씩 오른쪽으로 쉬프트하며 CRC 계산</span>\r\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">uint8_t</span> j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j <span class=\"token operator\">&lt;</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            CY <span class=\"token operator\">=</span> C <span class=\"token operator\">&amp;</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 하위 비트 추출</span>\r\n            C <span class=\"token operator\">=</span> C <span class=\"token operator\">>></span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 오른쪽으로 1비트 쉬프트</span>\r\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>CY <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                C <span class=\"token operator\">=</span> C <span class=\"token operator\">^</span> <span class=\"token number\">0xA001</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 하위 비트가 1이면 XOR 연산</span>\r\n            <span class=\"token punctuation\">}</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token comment\">// CRC 값을 데이터 배열의 마지막 두 바이트에 추가</span>\r\n    data<span class=\"token punctuation\">[</span>length<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> C <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// CRC_low</span>\r\n    data<span class=\"token punctuation\">[</span>length <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>C <span class=\"token operator\">>></span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// CRC_high</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token comment\">// Modbus RTU 요청 전송 함수</span>\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">sendModbusRequest</span><span class=\"token punctuation\">(</span>HANDLE hSerial<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint8_t</span> slaveAddress<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint16_t</span> startAddress<span class=\"token punctuation\">,</span> <span class=\"token class-name\">uint16_t</span> registerCount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token class-name\">uint8_t</span> request<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 요청 프레임 (8바이트)</span>\r\n\r\n    <span class=\"token comment\">// 요청 프레임 구성</span>\r\n    request<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> slaveAddress<span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 슬레이브 주소 설정</span>\r\n    request<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x04</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 기능 코드 설정 (0x04: Read Input Registers)</span>\r\n    request<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>startAddress <span class=\"token operator\">>></span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 시작 주소 상위 바이트 설정</span>\r\n    request<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> startAddress <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 시작 주소 하위 바이트 설정</span>\r\n    request<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>registerCount <span class=\"token operator\">>></span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 레지스터 수 상위 바이트 설정</span>\r\n    request<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> registerCount <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xFF</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 레지스터 수 하위 바이트 설정</span>\r\n\r\n    <span class=\"token comment\">// CRC 계산</span>\r\n    <span class=\"token function\">CRC_Maker</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 데이터 배열의 앞 6바이트를 사용하여 CRC 계산</span>\r\n\r\n    <span class=\"token comment\">// 요청 프레임 전송</span>\r\n    DWORD bytesWritten<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">WriteFile</span><span class=\"token punctuation\">(</span>hSerial<span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>bytesWritten<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// 전송 실패 시 에러 메시지 출력</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Failed to write to COM port\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// 전송 성공 시 메시지 출력</span>\r\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Modbus RTU Request sent\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token comment\">// COM 포트 설정 함수</span>\r\nHANDLE <span class=\"token function\">setupSerialPort</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span> portName<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// 지정된 COM 포트를 여는 함수</span>\r\n    HANDLE hSerial <span class=\"token operator\">=</span> <span class=\"token function\">CreateFile</span><span class=\"token punctuation\">(</span>\r\n        portName<span class=\"token punctuation\">,</span>  <span class=\"token comment\">// 포트 이름</span>\r\n        GENERIC_READ <span class=\"token operator\">|</span> GENERIC_WRITE<span class=\"token punctuation\">,</span>  <span class=\"token comment\">// 읽기 및 쓰기 설정</span>\r\n        <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\">// 공유 모드 없음</span>\r\n        <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\">// 보안 속성 없음</span>\r\n        OPEN_EXISTING<span class=\"token punctuation\">,</span>  <span class=\"token comment\">// 기존 포트 열기</span>\r\n        FILE_ATTRIBUTE_NORMAL<span class=\"token punctuation\">,</span>  <span class=\"token comment\">// 일반 파일 속성</span>\r\n        <span class=\"token constant\">NULL</span>  <span class=\"token comment\">// 템플릿 파일 없음</span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// 포트 열기 실패 시 INVALID_HANDLE_VALUE 반환</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hSerial <span class=\"token operator\">==</span> INVALID_HANDLE_VALUE<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">return</span> INVALID_HANDLE_VALUE<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token comment\">// 포트 설정 구조체 초기화</span>\r\n    DCB dcbSerialParams <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n    dcbSerialParams<span class=\"token punctuation\">.</span>DCBlength <span class=\"token operator\">=</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>dcbSerialParams<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// 현재 포트 상태 가져오기</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">GetCommState</span><span class=\"token punctuation\">(</span>hSerial<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>dcbSerialParams<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token function\">CloseHandle</span><span class=\"token punctuation\">(</span>hSerial<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 실패 시 포트 핸들 닫기</span>\r\n        <span class=\"token keyword\">return</span> INVALID_HANDLE_VALUE<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token comment\">// 포트 설정 (9600bps, 8 데이터 비트, 1 스톱 비트, 패리티 없음)</span>\r\n    dcbSerialParams<span class=\"token punctuation\">.</span>BaudRate <span class=\"token operator\">=</span> CBR_9600<span class=\"token punctuation\">;</span>\r\n    dcbSerialParams<span class=\"token punctuation\">.</span>ByteSize <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span>\r\n    dcbSerialParams<span class=\"token punctuation\">.</span>StopBits <span class=\"token operator\">=</span> ONESTOPBIT<span class=\"token punctuation\">;</span>\r\n    dcbSerialParams<span class=\"token punctuation\">.</span>Parity <span class=\"token operator\">=</span> NOPARITY<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// 포트 설정 적용</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">SetCommState</span><span class=\"token punctuation\">(</span>hSerial<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>dcbSerialParams<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token function\">CloseHandle</span><span class=\"token punctuation\">(</span>hSerial<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 실패 시 포트 핸들 닫기</span>\r\n        <span class=\"token keyword\">return</span> INVALID_HANDLE_VALUE<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token comment\">// 포트 타임아웃 설정</span>\r\n    COMMTIMEOUTS timeouts <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n    timeouts<span class=\"token punctuation\">.</span>ReadIntervalTimeout <span class=\"token operator\">=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">;</span>\r\n    timeouts<span class=\"token punctuation\">.</span>ReadTotalTimeoutConstant <span class=\"token operator\">=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">;</span>\r\n    timeouts<span class=\"token punctuation\">.</span>ReadTotalTimeoutMultiplier <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span>\r\n    timeouts<span class=\"token punctuation\">.</span>WriteTotalTimeoutConstant <span class=\"token operator\">=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">;</span>\r\n    timeouts<span class=\"token punctuation\">.</span>WriteTotalTimeoutMultiplier <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// 타임아웃 설정 적용</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">SetCommTimeouts</span><span class=\"token punctuation\">(</span>hSerial<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>timeouts<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token function\">CloseHandle</span><span class=\"token punctuation\">(</span>hSerial<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 실패 시 포트 핸들 닫기</span>\r\n        <span class=\"token keyword\">return</span> INVALID_HANDLE_VALUE<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token comment\">// 성공 시 포트 핸들 반환</span>\r\n    <span class=\"token keyword\">return</span> hSerial<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n</code></pre></div>\n<h3 id=\"설명\" style=\"position:relative;\"><a href=\"#%EC%84%A4%EB%AA%85\" aria-label=\"설명 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>설명</h3>\n<ol>\n<li>기능 코드 0x04 (Read Input Registers)를 사용하여 전력 사용량 데이터를 요청한다.</li>\n<li>요청 프레임을 구성하고 CRC를 계산하여 COM 포트를 통해 슬레이브 디바이스로 전송한다.</li>\n<li>1시간마다 요청을 전송하는 루프를 통해 주기적으로 데이터를 요청한다.</li>\n</ol>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#modbus-rtu-%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C-serial-remote-terminal-unit\">Modbus RTU 프로토콜 (Serial Remote Terminal Unit)</a></p>\n</li>\n<li>\n<p><a href=\"#%ED%94%84%EB%A0%88%EC%9E%84-%EA%B5%AC%EC%A1%B0\">프레임 구조</a></p>\n</li>\n<li>\n<p><a href=\"#%ED%86%B5%EC%8B%A0-%EB%B0%A9%EC%8B%9D\">통신 방식</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%A3%BC%EC%9A%94-%EA%B8%B0%EB%8A%A5-%EC%BD%94%EB%93%9C\">주요 기능 코드</a></p>\n<ul>\n<li><a href=\"#%EC%98%88%EC%A0%9C\">예제</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#crc-%EA%B2%80%EC%82%AC\">CRC 검사</a></p>\n<ul>\n<li><a href=\"#crc-%EC%BD%94%EB%93%9C-%EC%83%9D%EC%84%B1-%EB%B0%A9%EB%B2%95-c%EC%96%B8%EC%96%B4\">CRC 코드 생성 방법 (C언어)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%A0%84%EB%A0%A5%EA%B3%84%EC%97%90%EC%84%9C-%EC%A0%84%EB%A0%A5%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A5%BC-%EA%B0%80%EC%A0%B8%EC%98%A4%EB%8A%94-%EB%B2%95\">전력계에서 전력데이터를 가져오는 법</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%82%B4%EA%B0%80-%EC%82%B0-%EC%A0%84%EB%A0%A5%EA%B3%84%EC%9D%98-%ED%86%B5%EC%8B%A0-%EB%A0%88%EC%A7%80%EC%8A%A4%ED%84%B0-%EC%A3%BC%EC%86%8C-%EA%B5%AC%EC%84%B1\">내가 산 전력계의 통신 레지스터 주소 구성</a></p>\n<ul>\n<li><a href=\"#pm-b-pm-c-d-kcpm\">PM-B (PM-C, D, KCPM)</a></li>\n<li><a href=\"#%EC%A0%84%EB%A0%A5-%EC%82%AC%EC%9A%A9%EB%9F%89-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%9A%94%EC%B2%AD-%EC%BD%94%EB%93%9C-%EC%98%88%EC%8B%9C-c%EC%96%B8%EC%96%B4\">전력 사용량 데이터 요청 코드 예시 (C언어)</a></li>\n<li><a href=\"#%EC%84%A4%EB%AA%85\">설명</a></li>\n</ul>\n</li>\n</ul>\n</div>","excerpt":"Modbus RTU 프로토콜 (Serial Remote Terminal Unit)  Modbus 프로토콜은 시리얼과 TCP/UDP에서 활용할 수 있는데, 그중 시리얼통신인 485로 4선 통신하는 경우는 RTU가 많이 사용된다.\r\n구매한 전력계 제품은 2선통신 임에도 설계하신 분이 RTU를 사용하는 설계를 사용하셔서 2선 통신으로 RTU 프로토콜을 사용해보게 되었다. 프레임 구조 슬레이브 주소 (Slave Address): 1 바이트 (0-255) 기능 코드 (Function Code): 1 바이트 (1-255) 데이터 (Data): n 바이트 (기능 코드에 따라 다름) CRC: 2 바이트 통신 방식 Modbus RTU는 마스터-슬레이브 구조를 사용한다. 마스터 디바이스는 통신을 시작하고 슬레이브 디바이스는 응답하는 형태로 동작한다. 한 번에 하나의 마스터만 존재할 수 있으며, 다수의 슬레이브가 존재할 수 있다. 주요 기능 코드 0x01: Read Coil Status (디지털 출력…","frontmatter":{"date":"July 01, 2024","title":"RS-485 전력계의 Modbus RTU 프로토콜 통신","categories":"네트워크","author":"심우진","emoji":"🖥️"},"fields":{"slug":"/RS485_02/"}},"next":{"id":"89c56fa0-6f66-50cd-8589-dbc15c4ec029","html":"<h2 id=\"rs485-통신-결선\" style=\"position:relative;\"><a href=\"#rs485-%ED%86%B5%EC%8B%A0-%EA%B2%B0%EC%84%A0\" aria-label=\"rs485 통신 결선 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>RS485 통신 결선</h2>\n<h3 id=\"결선도-설명\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EC%84%A0%EB%8F%84-%EC%84%A4%EB%AA%85\" aria-label=\"결선도 설명 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>결선도 설명</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 444px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB0ElEQVQoz1VRy27TUBD1B4KEBEUsCUWAELCAPgIrKiQQH1EkYFu2ZQ2UVYmElJi0ft34lZTEJglJfB92fdCMA6KWzp05c+dx7tgaiQzp9whZNIEqSxipcb5UDQqNWhIUalWg1ktGZZbQ5RIrIzHVGrkqkRcG+ULBktkcRTKByn9Da81QBLO2/2AuQCsDowka5RrkW+a8gqpKyL/NpGqsUtBKsf0fTY68wOW6xhgD6+fZGeIwQjgIEfg+RCAgggCe6yEcDOB7PoQQiOMYnuuyz3lCwPd9jgV+gIEQSNMUFh2O48B1HNi2jdOTU/T7/bV/gh+2zXeu48Lu9dDtdpnTILrrdXs8gOpoiAUAWZZBSonprylWqxVzeg7Zqqrw9egIHw4OkMQx3r99hzRJ8GZ/H4vFgmN5lmGYps2TqWGapJjP5xiNRhzMJhlzUk+7mc1mvIaiKBCFIQ8llZRLKr98+ow4ipqGdLS3d3D/7j1sPX6CIAjw7fgYt2628OjBQ4RhSDPhex5ev3yF9s4uPh4eIo5iXLl0GXc2b+PGxnWu37h6DVZd1xgOh4jCiJOavya5URInzOmjFdAOO50OxuMxq95stfCs/RQvnu9hd2ubBfwB8ueH69FTxjEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Wire_01.png\"\n        title=\"Wire_01.png\"\n        src=\"/static/e43ddfaef967d46370e652b4cc534c7e/9b7bd/Wire_01.png\"\n        srcset=\"/static/e43ddfaef967d46370e652b4cc534c7e/e9ff0/Wire_01.png 180w,\n/static/e43ddfaef967d46370e652b4cc534c7e/f21e7/Wire_01.png 360w,\n/static/e43ddfaef967d46370e652b4cc534c7e/9b7bd/Wire_01.png 444w\"\n        sizes=\"(max-width: 444px) 100vw, 444px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>이미지에 나와 있는 결선도를 보면 다음과 같은 결선이 필요하다:</p>\n<ol>\n<li>1번 및 2번 핀: AC 300V 전원 공급</li>\n<li>3번 및 4번 핀: AC 5A 전원 공급</li>\n<li>5번 핀: A+ (RS485 통신선)</li>\n<li>6번 핀: B- (RS485 통신선)</li>\n<li>7번 핀: SG (Signal Ground)</li>\n<li>8번 및 9번 핀: AC 90~260V / DC 110V 전원 공급</li>\n</ol>\n<h3 id=\"결선-방법\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EC%84%A0-%EB%B0%A9%EB%B2%95\" aria-label=\"결선 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>결선 방법</h3>\n<ol>\n<li>\n<p><strong>전원 결선</strong>:</p>\n<ul>\n<li>1번과 2번 핀에 AC 300V 전원을 연결</li>\n<li>3번과 4번 핀에 AC 5A 전원을 연결</li>\n<li>8번과 9번 핀에 AC 90~260V 또는 DC 110V 전원을 연결</li>\n</ul>\n</li>\n<li>\n<p><strong>RS485 통신선 결선</strong>:</p>\n<ul>\n<li>A+ (5번 핀)와 B- (6번 핀)을 각각 RS485 장치의 A+와 B-에 연결</li>\n<li>SG (7번 핀)은 Signal Ground로 사용</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"tx와-rx의-개념\" style=\"position:relative;\"><a href=\"#tx%EC%99%80-rx%EC%9D%98-%EA%B0%9C%EB%85%90\" aria-label=\"tx와 rx의 개념 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TX와 RX의 개념</h2>\n<ul>\n<li><strong>TX (Transmit)</strong>: 송신, 데이터를 보내는 역할</li>\n<li><strong>RX (Receive)</strong>: 수신, 데이터를 받는 역할</li>\n</ul>\n<p>RS485는 차동 신호를 사용하여 데이터 전송을 하기 때문에 TX와 RX의 구분이 없다. A+와 B- 두 개의 라인으로 데이터가 양방향으로 전송된다.</p>\n<h2 id=\"serial-to-usb로-데이터-수신\" style=\"position:relative;\"><a href=\"#serial-to-usb%EB%A1%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%88%98%EC%8B%A0\" aria-label=\"serial to usb로 데이터 수신 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Serial to USB로 데이터 수신</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEDBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAGLhGNIYf/EABsQAAIBBQAAAAAAAAAAAAAAAAACAQMQEhMy/9oACAEBAAEFApY2sZtejx//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAYEAACAwAAAAAAAAAAAAAAAAABECAhMf/aAAgBAQAGPwKlph//xAAaEAEAAwADAAAAAAAAAAAAAAABACFREUGB/9oACAEBAAE/IULpA+5zW+EVW8guy1tn/9oADAMBAAIAAwAAABAIL//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAECAQE/EIf/xAAZEAEAAwEBAAAAAAAAAAAAAAABABEhMWH/2gAIAQEAAT8Q2TANDHaGAXdQHYr6jkVnmPdW52d+m3Z//9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Wire_02.jpg\"\n        title=\"Wire_02.jpg\"\n        src=\"/static/eea2f503f4279fdde9ef8a1315643013/80e3c/Wire_02.jpg\"\n        srcset=\"/static/eea2f503f4279fdde9ef8a1315643013/4ec73/Wire_02.jpg 180w,\n/static/eea2f503f4279fdde9ef8a1315643013/158ba/Wire_02.jpg 360w,\n/static/eea2f503f4279fdde9ef8a1315643013/80e3c/Wire_02.jpg 720w,\n/static/eea2f503f4279fdde9ef8a1315643013/47311/Wire_02.jpg 1080w,\n/static/eea2f503f4279fdde9ef8a1315643013/bb656/Wire_02.jpg 1297w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h4 id=\"rs485-to-usb-컨버터-핀-설명\" style=\"position:relative;\"><a href=\"#rs485-to-usb-%EC%BB%A8%EB%B2%84%ED%84%B0-%ED%95%80-%EC%84%A4%EB%AA%85\" aria-label=\"rs485 to usb 컨버터 핀 설명 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>RS485 to USB 컨버터 핀 설명</h4>\n<p>컨버터 핀 배치와 각각의 의미는 다음과 같다:</p>\n<ul>\n<li><strong>TRXD+ (Transmit/Receive Data Positive)</strong>: RS485의 A+ 선과 연결</li>\n<li><strong>TRXD- (Transmit/Receive Data Negative)</strong>: RS485의 B- 선과 연결</li>\n<li><strong>GND (Ground)</strong>: 신호 접지, RS485 장치의 SG와 연결</li>\n</ul>\n<h4 id=\"단계별-연결-방법\" style=\"position:relative;\"><a href=\"#%EB%8B%A8%EA%B3%84%EB%B3%84-%EC%97%B0%EA%B2%B0-%EB%B0%A9%EB%B2%95\" aria-label=\"단계별 연결 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>단계별 연결 방법</h4>\n<ol>\n<li>\n<p><strong>RS485 to USB 컨버터 준비</strong>:</p>\n<ul>\n<li>RS485 신호를 USB 신호로 변환하기 위해 RS485 to USB 컨버터가 필요하다.</li>\n</ul>\n</li>\n<li>\n<p><strong>RS485 to USB 컨버터 연결</strong>:</p>\n<ul>\n<li><strong>TRXD+</strong> (컨버터의 3번 핀)를 RS485 장치의 <strong>A+</strong> (5번 핀)에 연결</li>\n<li><strong>TRXD-</strong> (컨버터의 8번 핀)를 RS485 장치의 <strong>B-</strong> (6번 핀)에 연결</li>\n<li><strong>GND</strong> (컨버터의 5번 핀)를 RS485 장치의 <strong>SG</strong> (7번 핀)에 연결</li>\n</ul>\n</li>\n<li>\n<p><strong>PC에 USB 연결</strong>:</p>\n<ul>\n<li>RS485 to USB 컨버터를 PC의 USB 포트에 연결</li>\n</ul>\n</li>\n<li>\n<p><strong>시리얼 통신 소프트웨어 설치</strong>:</p>\n<ul>\n<li>Putty, Tera Term 또는 다른 시리얼 통신 소프트웨어를 설치하거나</li>\n<li>Serial 통신을 구현하는 소프트웨어를 간단하게 만들어서 사용</li>\n</ul>\n</li>\n<li>\n<p><strong>시리얼 포트 설정</strong>:</p>\n<ul>\n<li>시리얼 통신 소프트웨어에서 적절한 COM 포트를 선택</li>\n<li>이 제품의 경우 전송속도는 9600bps/19200bps (반2중, 조보동기방식)</li>\n<li>Data형식은 Start 1bit, Data 8bit, 패리티 None, Stop 1bit</li>\n<li>프로토콜 명은 Modbus RTU (인터페이스 : RS-485 2Wire)</li>\n</ul>\n</li>\n</ol>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#rs485-%ED%86%B5%EC%8B%A0-%EA%B2%B0%EC%84%A0\">RS485 통신 결선</a></p>\n<ul>\n<li><a href=\"#%EA%B2%B0%EC%84%A0%EB%8F%84-%EC%84%A4%EB%AA%85\">결선도 설명</a></li>\n<li><a href=\"#%EA%B2%B0%EC%84%A0-%EB%B0%A9%EB%B2%95\">결선 방법</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#tx%EC%99%80-rx%EC%9D%98-%EA%B0%9C%EB%85%90\">TX와 RX의 개념</a></p>\n</li>\n<li>\n<p><a href=\"#serial-to-usb%EB%A1%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%88%98%EC%8B%A0\">Serial to USB로 데이터 수신</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"#rs485-to-usb-%EC%BB%A8%EB%B2%84%ED%84%B0-%ED%95%80-%EC%84%A4%EB%AA%85\">RS485 to USB 컨버터 핀 설명</a></li>\n<li><a href=\"#%EB%8B%A8%EA%B3%84%EB%B3%84-%EC%97%B0%EA%B2%B0-%EB%B0%A9%EB%B2%95\">단계별 연결 방법</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"June 30, 2024","title":"RS485 통신 결선 및 데이터 수신 방법","categories":"네트워크","author":"심우진","emoji":"📡"},"fields":{"slug":"/RS485_01/"}},"prev":null,"site":{"siteMetadata":{"siteUrl":"https://woogooree.github.io","comments":{"utterances":{"repo":""}}}}},"pageContext":{"slug":"/RS485_02/","nextSlug":"/RS485_01/","prevSlug":""}},"staticQueryHashes":["1073350324","1956554647","2938748437"]}